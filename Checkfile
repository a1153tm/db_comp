# Additional columns
exec_date = {name: "exec_date", type: :date, nullable: false}
created_ts = {name: "created_ts", type: :timestamp, nullable: false}
date_timestamp = [exec_date, created_ts]
spare = [{name: "spare", type: :varchar, length: 256, nullable: true}]
file_nm = [{name: "file_nm", type: :varchar, length: 64, nullable: false}]
item_nm = {name: "item_nm", type: :varchar, length: 100, nullable: false}
icode_01_nm = {name: "icode_01_nm", type: :varchar, length: 100, nullable: false}
icode_02_nm = {name: "icode_02_nm", type: :varchar, length: 100, nullable: false}
icode_03_nm = {name: "icode_03_nm", type: :varchar, length: 100, nullable: false}
icode_04_nm = {name: "icode_04_nm", type: :varchar, length: 100, nullable: false}
jan_cd = {name: "jan_cd", type: :varchar, length: 13, nullable: false}
brand = [item_nm,icode_01_nm,icode_02_nm,icode_03_nm,icode_04_nm,jan_cd]
item_cd = [{name: "item_cd", type: :varchar, length: 18, nullable: false}]
not_icode_flg = [{name: "not_icode_flg", type: :bool, nullable: true}]
cal_sales_date = [{name: "cal_sales_date", type: :date, nullable: false}] 
change_flg = {name: "change_flg", type: :bool, nullable: true}
sales_hour_src = {name: "sales_hour_src", type: :smallint, nullable: false}
journal = [change_flg, sales_hour_src]
store_group_cd = {column: "store_group_cd", nullable: false}
store_group_nm = {column: "store_group_nm", nullable: false}
area_cd = {column: "area_cd", nullable: false}
area_nm = {column: "area_nm", nullable: false}
birth_date = {column: "birth_date", nullable: false}
sex_div = {column: "sex_div", nullable: false}
chain_icode_01_cd = {column: "icode_01_cd", nullable: false}
chain_icode_01_nm = {column: "icode_01_nm", nullable: false}
chain_icode_key = {column: "icode_key", nullable: false}
item_volume = {column: "item_volume", type: :decimal}
item_cd_null = {column: "item_cd", nullable: false}

# ms_calendar
mysql.ms_calendar == redshift.ms_calendar_ld
redshift.ms_calendar_ld == redshift.ms_calendar_tmp

# tx_journal
(redshift.tx_journal_ld + redshift.ms_store_tmp + redshift.ms_member_tmp + redshift.ms_calendar_tmp + journal).sort == (redshift.tx_journal_tmp.override(store_group_cd).override(store_group_nm).override(area_cd).override(area_nm).override(birth_date).override(sex_div) + spare + cal_sales_date + file_nm).sort
redshift.tx_journal_tmp + date_timestamp == redshift.tx_journal

# ms_store
redshift.ms_store_ld == redshift.ms_store_tmp + spare
redshift.ms_store_tmp == mysql.ms_store_ld 
mysql.ms_store_ld + date_timestamp == mysql.ms_store

# ms_member
redshift.ms_member_ld == redshift.ms_member_tmp + spare
redshift.ms_member_tmp == mysql.ms_member_ld
mysql.ms_member_ld + date_timestamp == mysql.ms_member

# ms_chain_item
redshift.ms_chain_item_ld == redshift.ms_chain_item_tmp + spare
(redshift.ms_chain_item_tmp + redshift.ms_icode_tmp + redshift.ms_brand_tmp + date_timestamp).sort == (redshift.ms_chain_item.override(chain_icode_01_cd).override(chain_icode_01_nm).override(chain_icode_key)).sort

#ms_icode
(redshift.ms_icode_ld + not_icode_flg).sort == redshift.ms_icode_tmp.sort
redshift.ms_icode_tmp == mysql.ms_icode_ld
mysql.ms_icode_ld + date_timestamp == mysql.ms_icode

# ms_brand
mysql.ms_brand_edit.override(item_volume).sort == redshift.ms_brand_ld.override(item_volume).sort
redshift.ms_brand_ld.override(item_volume).sort == (redshift.ms_brand_tmp.override(item_volume) + brand).sort
redshift.ms_brand_tmp.override(item_volume) == mysql.ms_brand_ld.override(item_volume)
(mysql.ms_brand_ld.override(item_volume ) + date_timestamp) == mysql.ms_brand.override(item_volume)

# ms_user_item
mysql.ms_user_item == redshift.ms_user_item_ld
redshift.ms_user_item_ld == redshift.ms_user_item

# ms_user_member
mysql.ms_user_member == redshift.ms_user_member_ld
redshift.ms_user_member_ld == redshift.ms_user_member

# ms_item
redshift.ms_item_tmp.override(item_cd_null) == redshift.ms_item_before

# ms_item_cd_seq
redshift.ms_item_cd_seq == redshift.ms_item_cd_seq_before

